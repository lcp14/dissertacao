hybrid approach revisit visibility pipeline
